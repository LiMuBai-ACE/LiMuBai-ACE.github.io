import{_ as s,c as a,o as n,a as l}from"./app.ad5e6bd3.js";const C=JSON.parse('{"title":"网络层面优化","description":"","frontmatter":{"isTimeLine":true,"title":"网络层面优化","date":"2020-04-14T00:00:00.000Z","tags":["大前端","性能优化"],"categories":["大前端"]},"headers":[{"level":2,"title":"DNS解析","slug":"dns解析","link":"#dns解析","children":[]},{"level":2,"title":"TCP连接","slug":"tcp连接","link":"#tcp连接","children":[]},{"level":2,"title":"Http请求/响应","slug":"http请求-响应","link":"#http请求-响应","children":[]},{"level":2,"title":"webpack 优化","slug":"webpack-优化","link":"#webpack-优化","children":[{"level":3,"title":"构建过程提速","slug":"构建过程提速","link":"#构建过程提速","children":[]},{"level":3,"title":"构建结果体积压缩","slug":"构建结果体积压缩","link":"#构建结果体积压缩","children":[]},{"level":3,"title":"拆分资源","slug":"拆分资源","link":"#拆分资源","children":[]},{"level":3,"title":"删除冗余代码","slug":"删除冗余代码","link":"#删除冗余代码","children":[]}]},{"level":2,"title":"Gzip 压缩","slug":"gzip-压缩","link":"#gzip-压缩","children":[{"level":3,"title":"开启Gzip","slug":"开启gzip","link":"#开启gzip","children":[]}]}],"relativePath":"pages/bigWeb/performance/Internet.md","lastUpdated":1679313190000}'),e={name:"pages/bigWeb/performance/Internet.md"},p=l(`<h1 id="网络层面优化" tabindex="-1">网络层面优化 <a class="header-anchor" href="#网络层面优化" aria-hidden="true">#</a></h1><h2 id="dns解析" tabindex="-1">DNS解析 <a class="header-anchor" href="#dns解析" aria-hidden="true">#</a></h2><ul><li>浏览器DNS缓存</li><li><a href="./dnsPre.html">DNS预解析</a></li></ul><h2 id="tcp连接" tabindex="-1">TCP连接 <a class="header-anchor" href="#tcp连接" aria-hidden="true">#</a></h2><ul><li><a href="https://blog.csdn.net/yanglianzhuang/article/details/87966866" target="_blank" rel="noreferrer">长连接</a>,HTTP/2中的多路复用</li><li>预连接</li><li>接入 <a href="https://baike.baidu.com/item/SPDY/3399551?fr=aladdin" target="_blank" rel="noreferrer">SPDY</a> 协议</li></ul><h2 id="http请求-响应" tabindex="-1">Http请求/响应 <a class="header-anchor" href="#http请求-响应" aria-hidden="true">#</a></h2><ul><li>减少请求次数</li><li>减少单次请求所花费的时间</li></ul><h2 id="webpack-优化" tabindex="-1">webpack 优化 <a class="header-anchor" href="#webpack-优化" aria-hidden="true">#</a></h2><h3 id="构建过程提速" tabindex="-1">构建过程提速 <a class="header-anchor" href="#构建过程提速" aria-hidden="true">#</a></h3><p><strong>babel-loader</strong></p><ul><li>使用include 或 exclude避免不必要的转译</li><li>开启缓存</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">\\.</span><span style="color:#C3E88D;">js</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">exclude</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/(</span><span style="color:#C3E88D;">node_modules</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">bower_components</span><span style="color:#89DDFF;">)/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">use</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">loader</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">babel-loader?cacheDirectory=true</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">options</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#FFCB6B;">presets</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@babel/preset-env</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">]</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><strong>处理第三方库</strong></p><p><a href="https://www.webpackjs.com/plugins/dll-plugin/" target="_blank" rel="noreferrer">DllPlugin</a> 是基于 Windows 动态链接库（dll）的思想被创作出来的。这个插件会把第三方库单独打包到一个文件中，这个文件就是一个单纯的依赖库。这个依赖库不会跟着你的业务代码一起被重新打包，只有当依赖自身发生版本变化时才会重新打包。</p><p><strong>将 loader 由单进程转为多进程</strong></p><p>webpack 是单线程的，当存在多个任务，只能排队一个接一个地等待处理。<a href="https://github.com/amireh/happypack" target="_blank" rel="noreferrer">Happypack</a> 会充分释放 CPU 在多核并发方面的优势，把任务分解给多个子进程去并发执行，大大提升打包效率。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> HappyPack </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">happypack</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">exports.</span><span style="color:#A6ACCD;">module </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">rules</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">.js</span><span style="color:#89DDFF;font-style:italic;">$</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 1) replace your original list of loaders with &quot;happypack/loader&quot;:</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// loaders: [ &#39;babel-loader?presets[]=es2015&#39; ],</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">use</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">happypack/loader</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">include</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [ </span><span style="color:#676E95;font-style:italic;">/* ... */</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">exclude</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [ </span><span style="color:#676E95;font-style:italic;">/* ... */</span><span style="color:#A6ACCD;"> ]</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">exports.</span><span style="color:#A6ACCD;">plugins </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 2) create the plugin:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">HappyPack</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 3) re-add the loaders you replaced above in #1:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">loaders</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [ </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">babel-loader?presets[]=es2015</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> ]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="构建结果体积压缩" tabindex="-1">构建结果体积压缩 <a class="header-anchor" href="#构建结果体积压缩" aria-hidden="true">#</a></h3><p><a href="https://www.npmjs.com/package/webpack-bundle-analyzer" target="_blank" rel="noreferrer">webpack-bundle-analyzer</a>,文件结构可视化，找出导致体积过大的原因</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> BundleAnalyzerPlugin </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">webpack-bundle-analyzer</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BundleAnalyzerPlugin</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">BundleAnalyzerPlugin</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="拆分资源" tabindex="-1">拆分资源 <a class="header-anchor" href="#拆分资源" aria-hidden="true">#</a></h3><h3 id="删除冗余代码" tabindex="-1">删除冗余代码 <a class="header-anchor" href="#删除冗余代码" aria-hidden="true">#</a></h3><ul><li>使用<code>Tree-Shaking</code>插件</li></ul><h2 id="gzip-压缩" tabindex="-1">Gzip 压缩 <a class="header-anchor" href="#gzip-压缩" aria-hidden="true">#</a></h2><h3 id="开启gzip" tabindex="-1">开启Gzip <a class="header-anchor" href="#开启gzip" aria-hidden="true">#</a></h3><p>在request headers中加入</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">accept</span><span style="color:#89DDFF;">-</span><span style="color:#FFCB6B;">encoding</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">gzip</span></span>
<span class="line"></span></code></pre></div><p>压缩后通常能帮我们减少响应 70% 左右的大小</p>`,28),o=[p];function t(r,c,i,D,y,F){return n(),a("div",null,o)}const h=s(e,[["render",t]]);export{C as __pageData,h as default};
