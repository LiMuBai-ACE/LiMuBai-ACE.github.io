import{_ as s,c as a,o as l,a as n}from"./app.ad5e6bd3.js";const C=JSON.parse('{"title":"提取样式表中url()中的内容","description":"","frontmatter":{"isTimeLine":true,"title":"提取样式表中url()中的内容","date":"2020-04-14T00:00:00.000Z","tags":["大前端","正则表达式"],"categories":["大前端"]},"headers":[{"level":2,"title":"反例","slug":"反例","link":"#反例","children":[{"level":3,"title":"chrome","slug":"chrome","link":"#chrome","children":[]},{"level":3,"title":"firefox","slug":"firefox","link":"#firefox","children":[]}]},{"level":2,"title":"第一步","slug":"第一步","link":"#第一步","children":[]},{"level":2,"title":"第二步","slug":"第二步","link":"#第二步","children":[]},{"level":2,"title":"最终","slug":"最终","link":"#最终","children":[]}],"relativePath":"pages/bigWeb/regexp/p1.md","lastUpdated":1679313190000}'),o={name:"pages/bigWeb/regexp/p1.md"},p=n(`<h1 id="提取样式表中url-中的内容" tabindex="-1">提取样式表中url()中的内容 <a class="header-anchor" href="#提取样式表中url-中的内容" aria-hidden="true">#</a></h1><p>开发中经常碰见元素使用<code>background</code>或者<code>background-imgae</code>等样式表提供的属性来展示图片而不是<code>img</code>使用标签,在修改的时候就会发现弊端在需要动态修改图片的时候没有<code>img.src</code>那样顺手,简单的法子就是提取出元素的<code>background</code>属性,然后使用<code>substr</code>字符传截取获取到的值,马虎的思考一下这确实没问题,但是真这样做了之后就发现了一个问题(说的正式在下😄),不同浏览器下面同样的代码获取到的结果不一致</p><h2 id="反例" tabindex="-1">反例 <a class="header-anchor" href="#反例" aria-hidden="true">#</a></h2><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">background:url(https://www.baidu.com/img/bd_logo1.png) 200px 100px;width:200px;height:100px</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querSelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">background</span></span>
<span class="line"></span></code></pre></div><h3 id="chrome" tabindex="-1">chrome <a class="header-anchor" href="#chrome" aria-hidden="true">#</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">url</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://www.baidu.com/img/bd_logo1.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) 200px 100px</span></span>
<span class="line"></span></code></pre></div><h3 id="firefox" tabindex="-1">firefox <a class="header-anchor" href="#firefox" aria-hidden="true">#</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">rgba</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">) </span><span style="color:#82AAFF;">url</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://www.baidu.com/img/bd_logo1.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) repeat scroll 200px 100px</span></span>
<span class="line"></span></code></pre></div><p>其它内核手头暂时没有,没有测试,使用传统的<code>substr</code>肯定是行不通了,接下来只有使用<code>正则表达式</code>去解决了</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>如果使用<code>style.backgroundImage</code>这两浏览器获取到的值就会是一样的了</p></div><p>下面是使用正则表达式去获取目标内容</p><h2 id="第一步" tabindex="-1">第一步 <a class="header-anchor" href="#第一步" aria-hidden="true">#</a></h2><p>匹配出<code>url(xxxx)</code>使用<code>/url\\(&quot;?&#39;?.*&quot;?&#39;?\\)/g</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> reg </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">url</span><span style="color:#A6ACCD;">\\(</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">*</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">\\)</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">g</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rgba(0, 0, 0, 0) url(&quot;https://www.baidu.com/img/bd_logo1.png&quot;) repeat scroll 200px 100px</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#A6ACCD;">(reg)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [&#39;url(&quot;https://www.baidu.com/img/bd_logo1.png&quot;)&#39;]</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url(https://www.baidu.com/img/bd_logo1.png)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#A6ACCD;">(reg)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// [&#39;url(&quot;https://www.baidu.com/img/bd_logo1.png&quot;)&#39;]</span></span>
<span class="line"></span></code></pre></div><h2 id="第二步" tabindex="-1">第二步 <a class="header-anchor" href="#第二步" aria-hidden="true">#</a></h2><p>剔除不相关的内容,<code>/&quot;|&#39;|url|\\(|\\)/g</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> reg </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">\\(</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">\\)</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">g</span></span>
<span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url(&quot;https://www.baidu.com/img/bd_logo1.png&quot;)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#A6ACCD;">(reg</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// https://www.baidu.com/img/bd_logo1.png</span></span>
<span class="line"></span></code></pre></div><h2 id="最终" tabindex="-1">最终 <a class="header-anchor" href="#最终" aria-hidden="true">#</a></h2><p>综合前面的例子</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getBackgroundUrl</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">background</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">regBackgroundUrl</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">url</span><span style="color:#A6ACCD;">\\(</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">*</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">?</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">\\)</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">g</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">regReplace</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">\\(</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">\\)</span><span style="color:#89DDFF;">/</span><span style="color:#F78C6C;">g</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">background</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">regBackgroundUrl</span><span style="color:#F07178;">)[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">regReplace</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">getBackgroundUrl</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rgba(0, 0, 0, 0) url(&quot;https://www.baidu.com/img/bd_logo1.png&quot;) repeat scroll 200px 100px</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// https://www.baidu.com/img/bd_logo1.png</span></span>
<span class="line"></span></code></pre></div>`,21),e=[p];function t(c,r,D,y,F,i){return l(),a("div",null,e)}const g=s(o,[["render",t]]);export{C as __pageData,g as default};
